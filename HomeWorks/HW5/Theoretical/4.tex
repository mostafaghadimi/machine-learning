\سؤال{}

$$
p(C_1) = \alpha, \: p(C_2) = 1 - \alpha
$$

حال اگر یک مجموعه‌ی داده
\footnote{\lr{dataset}}
با $n$ داده داشته باشیم داریم:

$$
p(x_n, C_1) = p(C_1)p(x_n|C_1) = \alpha N(x_n | \mu_1, \Sigma)
$$

$$
p(x_n, C_2) = p(C_2)p(x_n|C_2) = (1 - \alpha) N(x_n | \mu_2, \Sigma)
$$
حال اگر تابع \lr{likelihood} را بنویسیم، داریم:

$$
p(T | \alpha, \mu_1, \mu_2, \Sigma) = \Pi_{n = 1}^{N} [\alpha N(x_n | \mu_1, \Sigma)]^{t_n}[(1 - \alpha) N(x_n | \mu_2, \Sigma)]^{1 - t_n}
$$

با لگاریتم و سپس مشتق گرفتن داریم:
$$
\alpha = \frac{1}{N} \Sigma_{n = 1}^{N} t_n
$$

حال اگر با توجه به $\mu_1$ مشتق‌ (گرادیان) بگیریم داریم:

$$
\Sigma_{n = 1}^{N} t_n ln(N(x_n | \mu_1, \Sigma)) = -\frac{1}{2}\Sigma_{n = 1}^{N}t_n(x_n - \mu_1)^T \Sigma^{-1}(x_n - \mu_1) + constant
$$

$$
\implies
\begin{cases}
\mu_1 = \frac{1}{N}\Sigma_{n = 1}^{N}t_nx_n \\
\mu_2 = \frac{1}{N}\Sigma_{n = 1}^{N}(1 - t_n)x_n
\end{cases}
$$

$$
-\frac{1}{2}\Sigma_{n = 1}^{N}t_n ln|\Sigma| - \frac{1}{2} \Sigma_{n = 1}^{N}t_n(x_n - \mu_1)^T\Sigma^{-1}(x_n - \mu_1) - \frac{1}{2}\Sigma_{n = 1}^{N}(1-t_n)ln|\Sigma| - \frac{1}{2} \Sigma_{n = 1}^{N}(1 - t_n)(x_n - \mu_2)^T\Sigma_{-1}(x_n - \mu_2)
$$

$$
= -\frac{N}{2}ln|\Sigma| - \frac{N}{2}tr(\Sigma_{-1}S) 
$$

$$
S = \frac{N_1}{N}S_1 + \frac{N_2}{N}S_2 \implies 
\begin{cases}
S_1 = \frac{1}{N_1}\Sigma_{n \in C_1}(x_n - \mu_1)(x_n - \mu_1)^T \\
S_2 = \frac{1}{N_2}\Sigma_{n \in C_1}(x_n - \mu_2)(x_n - \mu_2)^T 
\end{cases} 
\rightarrow \Sigma = S
$$

